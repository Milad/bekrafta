language: php

php:
  - '5.6'
  - '7.0'
  - '7.1'
  - hhvm
  - nightly

install:
  # Install dependencies
  - if php -v | grep 'HipHop\|PHP 5.6'; then composer update; fi
  - composer install

before_script:
  # Check php syntax (Lynt)
  - if find {src,tests} -name "*.php" ! -path "./vendor/*" -exec php -l {} 2>&1 \; | grep "syntax error, unexpected"; then exit 1; fi

script:
  # PHP Mess Detector
  - php vendor/bin/phpmd src,tests text build/phpmd.xml
  # PHP Code Sniffer
  - php vendor/bin/phpcs --standard=build/phpcs.xml src tests
  # PHP Unit Test
  - php vendor/bin/phpunit --configuration tests/phpunit.xml
